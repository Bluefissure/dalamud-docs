# 插件提交和批准

本文介绍了决定哪些插件合并到官方存储库中以及如何确保进入的内容对您和我们都是安全
的过程。需要知道的是，本文中描述的内容都不适用于自定义存储库 - 我们只能为正式提
交其插件的开发人员执行此操作。

## 技术细节

首先，我们需要解释一下官方存储库中插件的提交流程是如何工作的。这有点简化，但这是
批准流程的基础。

- 官方存储库中的所有插件都是开源的，不接受闭源插件。这意味着任何人都可以检查它们
  的代码，如果他们愿意的话。
- 插件开发人员通过提交“提交哈希”来提交他们的插件，这是一个指向他们源代码的特定版
  本的加密哈希。在提交后更改其代码将导致新的哈希，这将要求他们重新提交并再次审核
  其更改。[^1]
- 然后，云构建系统下载该源代码，构建插件，并输出“差异”，这是对插件进行的所有更改
  的列表。构建系统没有直接的互联网访问权限，因此插件开发人员无法在构建插件时下载
  其他代码。
- 然后，[插件批准团队](#插件批准团队)的成员检查此差异。

所有这些结合在一起，使我们能够确保在用户的 PC 上运行的代码是我们批准的代码，并且
在我们批准之前不会在用户的硬件上运行任何代码。该系统旨在方便开发人员和审核人员，
并且应该很少产生负担 - 开发人员只需要在其项目配置中使用一些特定的变量即可。

## 插件批准团队

插件批准团队是由 6 名志愿者组成的主观选择小组，他们具有技术、安全意识，自己也是
插件开发人员，并且在 Dalamud 插件生态系统应该如何工作以及插件应该做什么和不应该
做什么方面达成共识。

他们批准新的插件提交，并审查现有插件的建议更改。

## 新提交

当插件首次提交时，团队会检查它是否符合一组
[指南](restrictions#我在插件中可以做什么) 和
[技术标准](https://github.com/goatcorp/DalamudPluginsD17#approval-criteria)。然
后，团队对每个新提交的插件进行投票 - 如果插件通过了 4 个赞成票，则它将获得批准并
出现在存储库中。每个团队成员都可以否决插件，阻止其合并，直到问题得到解决。这种情
况还没有发生过。

最重要的指南包括：

- 插件不会以自动化的方式与游戏服务器交互，例如轮询数据或在没有用户直接交互的情况
  下进行请求。
- 插件不会超出规范范围，例如允许玩家以正常手段无法实现的方式向服务器提交内容。
- 插件不会干扰战斗，除非它只提供有关您自己的团队成员的信息，而这些信息在其他情况
  下也是可用的，但以不同的方式表示。
- 请注意，存储库中有一些不遵守此规则的插件，但它们已被纳入老插件的范畴。我们认为
  删除它们是愚蠢的，但是这些插件在 Dalamud 的早期阶段就被接受了，我们已经学到了
  很多。如果它们现在提交，它们可能不会被接受。
- 插件不会干扰 Square Enix 的经济利益（例如授予 Mog Station 物品的访问权限）。

这些指南的存在是因为我们希望改善 Square Enix 提供的体验，而不是损害它或任何其他
玩家的游戏体验。我们认为它们为插件开发人员提供了很大的自由度，同时鼓励他们保持忠
于这个目标。

技术标准包括彻底的代码审查，插件的正常工作以及它不会上传任何个人数据。所有这些都
可能需要一段时间，因此新插件在队列中等待一周以上并不罕见

- 所有团队成员都是在业余时间做这件事情，因此可能在那之前无法处理它们。

我们还要求所有新插件在之前通过插件测试渠道，这将在将插件分发给所有使用 Dalamud
的人之前将其分发给测试用户。这有助于跟踪潜在的问题和错误。

## 插件更新

插件的更新只需要一个团队成员的批准，这有助于保持队列的小型化。更改的代码会经过仔
细审核，然后更新的插件将被构建和分发。

![What a plugin approval team member sees when they are being called in to review a change to a plugin.](https://user-images.githubusercontent.com/16760685/217103831-de5c1af3-7244-438e-8e8e-7408d2545814.png)

## 注意事项

虽然这一切都很好 - 它一直很好地为我们工作，没有发生任何事故 - 但所有这些工作都是
由志愿者完成的，他们可能会错过或忽略一些事情。我们不能也不想给您一个 100% 的保证
，保证一切都会很好，但我们相信我们可以给您一个相当好的保证。

由您决定信任谁！

## 结语

我们希望这有助于澄清插件如何进入官方 Dalamud 插件列表。如果您有任何问题或认为这
里的某些内容可以澄清，请随时联系我们。

[^1]:
    从技术上讲，这仍然是可能的，但您需要 NSA 级别的数据中心和大量时间（目前可能
    需要数百年）来破解 Git 使用的哈希算法。
